<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>气象数据可视化系统 | 2023-01-01起</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- 顶部控制栏 -->
        <div class="top-bar">
            <div class="group-selector">
                {% for group in groups %}
                <button class="group-btn" data-group="{{ group }}">
                    <i class="fas fa-{{ 'thermometer-half' if '温度' in group else 'wind' }}"></i>
                    <span>{{ group }}</span>
                </button>
                {% endfor %}
            </div>
            <div class="time-display">
                <div class="system-time">
                    <i class="fas fa-clock"></i>
                    <span id="system-clock">--:--:--</span>
                </div>
                <div class="fixed-time-range">
                    <span id="current-range">2023/01/01 01:00</span>
                    <span class="range-separator">至</span>
                    <span id="end-range">2023/01/03 01:00</span>
                </div>
            </div>
        </div>

        <!-- 主显示区域 -->
        <div class="main-display">
            <div class="image-container">
                <img id="current-image" src="" alt="气象数据图片" crossorigin="anonymous">
                <div class="image-overlay">
                    <div class="image-meta">
                        <div class="meta-left">
                            <span id="current-group" class="group-tag">
                                <i class="fas fa-layer-group"></i>
                                <span>{{ groups[0] }}</span>
                            </span>
                            <span id="data-time" class="time-tag">
                                <i class="fas fa-calendar-alt"></i>
                                <span id="display-date">2023/01/01</span>
                                <span id="display-time">01:00</span>
                            </span>
                        </div>
                        <div class="meta-right">
                            <span id="image-index" class="index-tag">
                                <span id="current-index">01</span>
                                <span class="index-separator">/</span>
                                <span id="total-images">48</span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 48小时时间轴 -->
        <div class="timeline-section">
            <div class="timeline-container">
                <!-- 时间轴刻度 -->
                <div class="timeline">
                    <div class="timeline-track">
                        <!-- 日期标记（2023-01-01 和 2023-01-02） -->
                        <div class="date-markers">
                            <div class="date-marker start-marker" style="left: 0%">
                                <div class="marker-line"></div>
                                <div class="marker-label">2023-01-01</div>
                            </div>
                            <div class="date-marker mid-marker" style="left: 50%">
                                <div class="marker-line"></div>
                                <div class="marker-label">2023-01-02</div>
                            </div>
                            <div class="date-marker end-marker" style="left: 100%">
                                <div class="marker-line"></div>
                                <div class="marker-label">2023-01-03</div>
                            </div>
                        </div>
                        
                        <!-- 时间刻度 -->
                        <div class="hour-ticks">
                            {% for i in range(0, 49, 6) %}
                            <div class="hour-tick" style="left: {{ i*100/48 }}%">
                                <div class="tick-line"></div>
                                <div class="tick-label">
                                    {% set hour = i + 1 %}
                                    {% if hour <= 24 %}
                                        {{ hour }}:00
                                    {% else %}
                                        {{ hour-24 }}:00
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <!-- 进度轨道 -->
                        <div class="progress-track" id="progress-track">
                            <div class="progress-background"></div>
                            <div id="progress-fill" class="progress-fill"></div>
                            <div id="progress-handle" class="progress-handle">
                                <div class="handle-tooltip" id="handle-time">01:00</div>
                            </div>
                        </div>
                        
                        <!-- 当前时间指示器 -->
                        <div id="current-marker" class="current-marker">
                            <div class="marker-pointer"></div>
                            <div class="marker-label">当前位置</div>
                        </div>
                    </div>
                </div>

                <!-- 控制面板 -->
                <div class="control-panel">
                    <div class="control-buttons">
                        <button id="prev-btn" class="control-btn" title="上一小时">
                            <i class="fas fa-step-backward"></i>
                        </button>
                        <button id="play-pause-btn" class="control-btn play-btn" title="播放/暂停">
                            <i id="play-icon" class="fas fa-play"></i>
                        </button>
                        <button id="next-btn" class="control-btn" title="下一小时">
                            <i class="fas fa-step-forward"></i>
                        </button>
                        <button id="jump-start-btn" class="control-btn" title="跳转到开始">
                            <i class="fas fa-fast-backward"></i>
                        </button>
                    </div>
                    
                    <div class="speed-control">
                        <span class="speed-label"><i class="fas fa-tachometer-alt"></i> 播放速度</span>
                        <div class="speed-slider-container">
                            <input type="range" id="speed-slider" min="0.25" max="4" step="0.25" value="1">
                            <div class="speed-ticks">
                                <span>0.25x</span>
                                <span>1x</span>
                                <span>2x</span>
                                <span>4x</span>
                            </div>
                        </div>
                        <span id="speed-display" class="speed-value">1x</span>
                    </div>
                    
                    <div class="time-navigation">
                        <span class="nav-label"><i class="fas fa-crosshairs"></i> 快速跳转</span>
                        <div class="nav-buttons">
                            <button class="nav-btn" data-hour="1">01:00</button>
                            <button class="nav-btn" data-hour="13">13:00</button>
                            <button class="nav-btn" data-hour="25">次日01:00</button>
                            <button class="nav-btn" data-hour="37">次日13:00</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 底部状态栏 -->
        <div class="status-bar">
            <div class="status-content">
                <div class="status-info">
                    <span class="status-dot active"></span>
                    <span id="status-text" class="status-text">系统就绪</span>
                </div>
                <div class="storage-info">
                    <span id="storage-status">
                        <i class="fas fa-database"></i>
                        <span>持久化存储已启用</span>
                    </span>
                </div>
                <div class="time-reference">
                    <span>
                        <i class="fas fa-calendar-day"></i>
                        <span>时间基准：2023年1月1日 01:00</span>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- 文件上传面板（简化版） -->
    <div class="upload-panel" id="upload-panel">
        <div class="upload-header">
            <h4><i class="fas fa-cloud-upload-alt"></i> 上传图片到持久存储</h4>
            <button class="close-upload" id="close-upload">&times;</button>
        </div>
        <div class="upload-body">
            <div class="upload-form">
                <div class="form-group">
                    <label for="upload-group"><i class="fas fa-layer-group"></i> 选择数据组</label>
                    <select id="upload-group">
                        {% for group in groups %}
                        <option value="{{ group }}">{{ group }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="upload-index"><i class="fas fa-hashtag"></i> 图片序号 (1-48)</label>
                    <input type="number" id="upload-index" min="1" max="48" value="1">
                </div>
                <div class="form-group">
                    <label for="upload-file"><i class="fas fa-file-image"></i> 选择图片文件</label>
                    <input type="file" id="upload-file" accept=".jpg,.jpeg,.png,.gif,.webp,.bmp">
                </div>
                <button id="upload-submit" class="upload-submit-btn">
                    <i class="fas fa-upload"></i> 上传到持久存储
                </button>
                <div id="upload-result" class="upload-result"></div>
            </div>
        </div>
    </div>

    <!-- 上传按钮 -->
    <button class="upload-toggle-btn" id="upload-toggle">
        <i class="fas fa-upload"></i>
    </button>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>